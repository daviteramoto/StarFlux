<h2>Dashboard de Vazão de Água</h2>

<div id="vazaoContainer">
    <canvas id="vazaoChart" width="400" height="200"></canvas>
</div>

<script>
    $(document).ready(function () {
        var ctx = document.getElementById('vazaoChart');
        var vazaoChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [0],
                datasets: [{
                    label: 'Vazão de Água',
                    data: [0],
                    fill: false,
                    borderColor: 'blue',
                    tension: 0.1
                }]
            },
            options: {
                /*scales: {
                    xAxes: {
                        type: 'linear',
                        position: 'bottom'
                    },
                    yAxes: {
                        min: 0
                    }
                }*/
            }
        });

        function addDataToChart(timestamp, vazao) {
            if (vazaoChart.data.datasets[0].data.length >= 15){
                vazaoChart.data.labels.shift();
                vazaoChart.data.datasets[0].data.shift();
            }
            vazaoChart.data.labels.push(timestamp);
            vazaoChart.data.datasets[0].data.push(vazao);
            vazaoChart.update();
        }

        function updateChart() {
            $.ajax({
                url: '/Dashboard/GetVazaoTempoReal',
                type: 'GET',
                success: function (data) {
                    addDataToChart(data.timestamp, data.vazao);
                    console.log(data);
                },
                error: function () {
                    console.error('Erro ao obter dados de vazão em tempo real.');
                }
            });
        }

        setInterval(updateChart, 2000);
    });
</script>